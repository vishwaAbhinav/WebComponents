<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <link rel="stylesheet" href="lib/autoCompltr-master/dist/css/autoCompltr.css">
    <title>Web Components - complex filter</title>
    <template id="complexFilterTemplate">
        <style>
            .outer {
                border: 2px solid brown;
                background: navajowhite;
                font-size: 12pt;
                width: 12em;
                height: 8em;
            }
            .checkbox-div {
                height: 5em;
                overflow: auto;
            }
        </style>
        <div class="outer">
            <div class="title">
                <content select=".title-holder"></content>
            </div>
            <div class="checkbox-div"><content select=".checkbox-holder"></content></div>
            <div class="auto-complete-popup"></div>
        </div>
        <script>

        </script>
    </template>
</head>
<body>
    <complex-filter>
        <label class="title-holder">Portfolio</label>
        <div class="checkbox-holder"></div>
    </complex-filter>
    <script src="lib/webcomponents.js"></script>
    <script src="lib/autoCompltr-master/dist/js/autoCompltr.js"></script>
    <script>
        "use strict";
        var listElements = ["Portfolio 1", "Portfolio 2", "Portfolio 3", "Portfolio 4","Portfolio 5", "Portfolio 6", "Portfolio 7", "Portfolio 8"];
        
        var proto = Object.create(HTMLElement.prototype);
        proto.createdCallback = function() {
            var root = this.createShadowRoot();
            var template = document.querySelector("#complexFilterTemplate");

            for(var i in listElements) {
                var tmpDiv = document.createElement("div");
                tmpDiv.style.display = "block";
                tmpDiv.style.marginLeft = "80px";
                var tmpCheck = document.createElement("input");
                tmpCheck.setAttribute("type", "checkbox");
                tmpDiv.appendChild(tmpCheck);
                tmpDiv.appendChild(document.createTextNode(listElements[i]));
                document.querySelector(".checkbox-holder").appendChild(tmpDiv);

                var observer = new MutationObserver(function(mutations, observer) {
                  mutations.forEach(function(record) {
                    for (var i = 0, node; node = record.addedNodes[i]; i++) {
                      console.log(node);
                    }
                  });
                });

                observer.observe(tmpDiv, {
                    childList: true
                });
            }
            var clone = document.importNode(template.content, true);
            root.appendChild(clone);
            var autoCompltr = new AutoCompltr(root.querySelector(".auto-complete-popup"));
            autoCompltr.setSuggestionsList(listElements);
            autoCompltr.clickableSuggestion(listElements);
        };
        var complexFilter = document.registerElement("complex-filter",{
          prototype : proto
        });


    </script>
</body>
</html>